<!DOCTYPE html>
<html lang="uz">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Korxona Profili - FAXR MADAD KONSALT</title>
    <style>
        :root {
            --primary: #1e40af;
            /* Royal Blue */
            --secondary: #64748b;
            /* Slate Gray */
            --bg: #f8fafc;
            --paper: #ffffff;
            --border: #e2e8f0;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: #1e293b;
            margin: 0;
            padding: 20px;
            font-size: 14px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: var(--paper);
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        /* HEADER & BRANDING */
        header {
            border-bottom: 2px solid var(--primary);
            padding-bottom: 20px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        h1 {
            color: var(--primary);
            margin: 0;
            font-size: 1.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .brand-sub {
            color: var(--secondary);
            font-weight: 500;
            margin-top: 5px;
        }

        .author-info {
            text-align: right;
            font-size: 0.85rem;
            color: var(--secondary);
            font-style: italic;
        }

        /* SECTIONS */
        .section-title {
            background: #f1f5f9;
            padding: 10px 15px;
            border-left: 4px solid var(--primary);
            color: var(--primary);
            font-weight: bold;
            font-size: 1.1rem;
            margin-top: 30px;
            margin-bottom: 20px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #475569;
        }

        input,
        select,
        textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 1rem;
            box-sizing: border-box;
            transition: border-color 0.2s;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* TABLES */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th,
        td {
            border: 1px solid var(--border);
            padding: 10px;
            text-align: left;
        }

        th {
            background: #f8fafc;
            font-weight: 600;
        }

        .btn-sm {
            padding: 4px 8px;
            font-size: 0.8rem;
            cursor: pointer;
        }

        .btn-danger {
            background: #fee2e2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }

        .btn-add {
            margin-top: 10px;
            background: #dbeafe;
            color: var(--primary);
            border: 1px solid #bfdbfe;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
        }

        /* ACTION BAR */
        .action-bar {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 6px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            box-shadow: 0 2px 4px rgba(37, 99, 235, 0.2);
        }

        .btn-primary:hover {
            background: #1d4ed8;
        }

        .btn-print {
            background: #334155;
            color: white;
        }

        .btn-print:hover {
            background: #1e293b;
        }

        /* PRINT STYLES */
        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
                max-width: 100%;
                padding: 0;
                margin: 0;
            }

            .no-print,
            .btn-add,
            .btn-danger {
                display: none !important;
            }

            input,
            select,
            textarea {
                border: none;
                padding: 0;
                background: transparent;
                /* Appearance adjustment for print */
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
            }

            /* For select elements, we might want to just show the selected text, 
               but standard print often keeps the dropdown arrow. 
               A robust solution is JS replacement, but for simplicity we rely on CSS. */

            .section-title {
                border-left: none;
                border-bottom: 2px solid #000;
                padding-left: 0;
                color: #000;
            }

            header {
                border-bottom: 2px solid #000;
            }

            h1 {
                color: #000;
            }
        }

        /* LOGIN MODAL & USER INFO */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .modal {
            background: white;
            padding: 2rem;
            border-radius: 16px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .modal h2 {
            margin-top: 0;
            color: #1e293b;
            margin-bottom: 1rem;
        }

        .modal input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            margin-bottom: 1rem;
            box-sizing: border-box;
        }

        .modal button {
            width: 100%;
            padding: 12px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
        }

        .student-display {
            background: #e0e7ff;
            color: #3730a3;
            padding: 8px 15px;
            border-radius: 8px;
            margin-top: 10px;
            font-weight: bold;
            border: 1px solid #c7d2fe;
            display: inline-block;
        }
    </style>
</head>

<body>

    <div class="container">
        <header>
            <div style="flex:1;">
                <h1>KORXONA PASPORTI</h1>
                <div class="brand-sub">FAXR MADAD KONSALT</div>
            </div>
            <div style="text-align:right;">
                <button onclick="openQuiz()" class="btn btn-sm no-print"
                    style="background:#8b5cf6; color:white; border:none; box-shadow:0 2px 5px rgba(139, 92, 246, 0.4); margin-bottom:10px; font-size:1rem; padding:8px 16px;">
                    üß† Bilimni Sinash
                </button>
                Muallif: Suxrat Abdullaev<br>
                Buxgalteriya va Soliq hisobi
            </div>
            <div id="header-student-info" class="student-display" style="display:none;">
                üë§ Talaba: <span id="disp_name">...</span> | Guruh: <span id="disp_group">...</span>
            </div>
    </div>
    </div>
    </header>

    <form id="profileForm" onsubmit="event.preventDefault(); saveData();">

        <!-- 1. UMUMIY MA'LUMOTLAR -->
        <div class="section-title" style="margin-top:0;">1. Umumiy Ma'lumotlar</div>
        <div class="form-grid">
            <div class="form-group">
                <label>Korxona To'liq Nomi</label>
                <input type="text" id="company_name" placeholder="Masalan: MCHJ &quot;AVECO TRADE&quot;">
            </div>
            <div class="form-group">
                <label>STIR (INN)</label>
                <input type="number" id="company_inn" placeholder="9 xonalik son">
            </div>
            <div class="form-group" style="grid-column: span 2;">
                <label>Yuridik Manzil</label>
                <input type="text" id="company_address" placeholder="Shahar, Tuman, Ko'cha, Uy">
            </div>
            <div class="form-group">
                <label>Asosiy Faoliyat Turi</label>
                <input type="text" id="activity_main" placeholder="Masalan: Savdo">
            </div>
            <div class="form-group">
                <label>Qo'shimcha Faoliyat</label>
                <input type="text" id="activity_extra" placeholder="Masalan: Xizmat ko'rsatish">
            </div>
            <div class="form-group">
                <label>OKED Kodi</label>
                <input type="text" id="company_oked">
            </div>
            <div class="form-group">
                <label>Ro'yxatdan o'tgan sana</label>
                <input type="date" id="reg_date">
            </div>
        </div>

        <!-- 2. USTAV KAPITALI -->
        <div class="section-title">2. Ustav Kapitali va Ta'sischilar</div>
        <div class="form-group">
            <label>Jami Ustav Fondi (So'm)</label>
            <input type="text" id="total_capital" readonly style="font-weight:bold; background:#f1f5f9;">
        </div>

        <table id="foundersTable">
            <thead>
                <tr>
                    <th width="40%">Ta'sischi (F.I.Sh / Nom)</th>
                    <th width="20%">Turi</th>
                    <th width="15%">Ulushi (%)</th>
                    <th width="20%">Summasi</th>
                    <th class="no-print" width="5%"></th>
                </tr>
            </thead>
            <tbody>
                <!-- JS Rows -->
            </tbody>
        </table>
        <button type="button" class="btn-add no-print" onclick="addFounder()">+ Ta'sischi Qo'shish</button>

        <!-- 3. BANK REKVIZITLARI -->
        <div class="section-title">3. Bank Rekvizitlari</div>
        <div class="form-grid">
            <div class="form-group">
                <label>Xizmat Ko'rsatuvchi Bank</label>
                <input type="text" id="bank_name" placeholder="Masalan: ATB &quot;Kapitalbank&quot;">
            </div>
            <div class="form-group">
                <label>Bank MFO</label>
                <input type="text" id="bank_mfo" placeholder="5 xonalik kod">
            </div>
            <div class="form-group" style="grid-column: span 2;">
                <label>Asosiy Hisob Raqam (20208...)</label>
                <input type="text" id="bank_account" placeholder="20 ta raqam">
            </div>
        </div>

        <!-- 4. RAHBARIYAT -->
        <div class="section-title">4. Rahbariyat va Mas'ullar</div>
        <div class="form-grid">
            <div class="form-group">
                <label>Direktor (F.I.Sh)</label>
                <input type="text" id="director_name">
            </div>
            <div class="form-group">
                <label>Telefon</label>
                <input type="text" id="director_phone">
            </div>

            <div class="form-group">
                <label>Bosh Buxgalter</label>
                <select id="accountant_type" onchange="toggleAccountantField()">
                    <option value="director">Direktorning O'zi</option>
                    <option value="staff">Alohida Shtat Xodimi</option>
                    <option value="outsource">Autsorsing Firma</option>
                </select>
            </div>
            <div class="form-group">
                <label>Buxgalter F.I.Sh / Firma Nomi</label>
                <input type="text" id="accountant_name" disabled>
            </div>

            <div class="form-group">
                <label>Kassir</label>
                <input type="text" id="cashier_name">
            </div>
        </div>

        <!-- 5. HISOB SIYOSATI -->
        <div class="section-title">5. Hisob Siyosati va Tartib</div>
        <div class="form-grid">
            <div class="form-group">
                <label>Soliq Rejimi</label>
                <select id="tax_regime">
                    <option value="aylanma">Aylanmadan Soliq (4%)</option>
                    <option value="nds">QQS va Foyda Solig'i</option>
                    <option value="fixed">Qat'iy Belgilangan Soliq</option>
                </select>
            </div>
            <div class="form-group">
                <label>QQS To'lovchisi?</label>
                <select id="is_vat">
                    <option value="no">Yo'q</option>
                    <option value="yes">Ha (12%)</option>
                </select>
            </div>

            <div class="form-group">
                <label>TMZni hisobga olish tizimi</label>
                <select id="inventory_system">
                    <option value="uzluksiz">Uzluksiz (Doimiy)</option>
                    <option value="davriy">Davriy</option>
                </select>
            </div>
            <div class="form-group">
                <label>TMZ tannarxini aniqlash (FIFO/AVECO)</label>
                <select id="inventory_method">
                    <option value="fifo">FIFO (Birinchi kirim - Birinchi chiqim)</option>
                    <option value="aveco">AVECO (O'rtacha tortilgan qiymat)</option>
                    <option value="ident">Identifikatsiyalangan tannarx</option>
                </select>
            </div>

            <div class="form-group">
                <label>Amortizatsiya Usuli (AV)</label>
                <select id="depreciation_method">
                    <option value="linear">To'g'ri chiziqli (Teng maromli)</option>
                    <option value="production">Ishlab chiqarish hajmi bo'yicha</option>
                    <option value="accelerated">Tezlashtirilgan usul</option>
                </select>
            </div>
            <div class="form-group">
                <label>Kam baholi buyumlar (Inventar) limiti</label>
                <input type="text" id="low_value_limit" placeholder="Masalan: 10 BHM gacha">
            </div>

            <div class="form-group">
                <label>Ish Tartibi</label>
                <select id="work_schedule">
                    <option value="5">5 kunlik ish haftasi</option>
                    <option value="6">6 kunlik ish haftasi</option>
                </select>
            </div>
            <div class="form-group">
                <label>Hisobot Topshirish Sanasi</label>
                <input type="text" id="report_deadline" placeholder="Masalan: Har oyning 15-sanasigacha">
            </div>
            <div class="form-group">
                <label>Soliq To'lash Sanasi</label>
                <input type="text" id="tax_deadline" placeholder="Masalan: Har oyning 20-sanasigacha">
            </div>
            <div class="form-group">
                <label>Oylik To'lash Sanasi</label>
                <input type="text" id="salary_date" placeholder="Masalan: Keyingi oyning 5-sanasi">
            </div>
        </div>

        <!-- ACTIONS -->
        <div class="action-bar no-print">
            <button type="submit" class="btn btn-primary">
                üíæ Saqlash
            </button>
            <button type="button" class="btn btn-print" onclick="window.print()">
                üñ®Ô∏è Chop Etish
            </button>
        </div>

    </form>
    </div>

    <script>
        // --- LOGIC ---
        function toggleAccountantField() {
            const type = document.getElementById('accountant_type').value;
            const input = document.getElementById('accountant_name');
            if (type === 'director') {
                input.value = document.getElementById('director_name').value;
                input.disabled = true;
            } else {
                input.disabled = false;
                if (input.value === document.getElementById('director_name').value) input.value = '';
            }
        }

        // FOUNDERS LOGIC
        function addFounder(name = '', type = 'physical', percent = '', sum = '') {
            const tbody = document.querySelector('#foundersTable tbody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><input type="text" value="${name}" class="f_name" placeholder="F.I.Sh"></td>
                <td>
                    <select class="f_type">
                        <option value="physical" ${type === 'physical' ? 'selected' : ''}>Jismoniy Shaxs</option>
                        <option value="legal" ${type === 'legal' ? 'selected' : ''}>Yuridik Shaxs</option>
                    </select>
                </td>
                <td><input type="number" value="${percent}" class="f_percent" oninput="calcTotal()" placeholder="%"></td>
                <td><input type="number" value="${sum}" class="f_sum" oninput="calcTotal()" placeholder="So'm"></td>
                <td class="no-print">
                    <button type="button" class="btn-sm btn-danger" onclick="this.closest('tr').remove(); calcTotal()">x</button>
                </td>
            `;
            tbody.appendChild(row);
        }

        function calcTotal() {
            let total = 0;
            document.querySelectorAll('.f_sum').forEach(input => {
                total += Number(input.value) || 0;
            });
            document.getElementById('total_capital').value = total.toLocaleString() + " so'm";
        }

        // STORAGE LOGIC
        function saveData() {
            const data = {};
            // Inputs
            document.querySelectorAll('input:not(.f_name):not(.f_percent):not(.f_sum), select:not(.f_type), textarea').forEach(el => {
                if (el.id) data[el.id] = el.value;
            });

            // Founders
            data.founders = [];
            document.querySelectorAll('#foundersTable tbody tr').forEach(row => {
                data.founders.push({
                    name: row.querySelector('.f_name').value,
                    type: row.querySelector('.f_type').value,
                    percent: row.querySelector('.f_percent').value,
                    sum: row.querySelector('.f_sum').value
                });
            });

            localStorage.setItem('company_profile', JSON.stringify(data));

            // Visual feedback
            const btn = document.querySelector('.btn-primary');
            const originalText = btn.innerHTML;
            btn.innerHTML = "‚úÖ Saqlandi!";
            setTimeout(() => btn.innerHTML = originalText, 2000);
        }

        function loadData() {
            const raw = localStorage.getItem('company_profile');
            if (!raw) {
                // Default placeholder row
                addFounder();
                return;
            }

            const data = JSON.parse(raw);

            // Inputs
            for (let key in data) {
                if (key === 'founders') continue;
                const el = document.getElementById(key);
                if (el) el.value = data[key];
            }

            // Founders
            const tbody = document.querySelector('#foundersTable tbody');
            tbody.innerHTML = '';
            if (data.founders && data.founders.length > 0) {
                data.founders.forEach(f => addFounder(f.name, f.type, f.percent, f.sum));
            } else {
                addFounder();
            }
            calcTotal();
            toggleAccountantField(); // Update state based on loaded value
        }

        // INIT
        window.addEventListener('DOMContentLoaded', loadData);

    </script>
    <script>
        // --- QUIZ LOGIC (MINI-TRENAJYOR - REGISTRATION) ---
        const quizQuestions = [
            { q: "Korxona ro'yxatdan o'tkazilganda Ustav kapitali shakllantirildi (Ta'sischilar qarzi) (100,000,000 so'm)", dt: "4610", kt: "8330", sum: 100000000 },
            { q: "Ta'sischi ustav kapitaliga pul mablag'i kiritdi (Bank hisob raqamiga) (50,000,000 so'm)", dt: "5110", kt: "4610", sum: 50000000 },
            { q: "Ta'sischi ustav kapitaliga Asosiy vosita (Bino) kiritdi (Ustav bo'yicha bahosi) (40,000,000 so'm)", dt: "0120", kt: "4610", sum: 40000000 },
            { q: "Ta'sischi ustav kapitaliga Tovarlar kiritdi (10,000,000 so'm)", dt: "2910", kt: "4610", sum: 10000000 },
            { q: "Davlat ro'yxatidan o'tish yig'imi to'landi (Bankdan) (300,000 so'm)", dt: "9420", kt: "5110", sum: 300000 },
            { q: "Muhr va shtamp tayyorlash uchun oldindan to'lov qilindi (500,000 so'm)", dt: "4310", kt: "5110", sum: 500000 },
            { q: "Muhr va shtamp korxonaga kirim qilindi (Inventar) (500,000 so'm)", dt: "1080", kt: "6010", sum: 500000 },
            { q: "Ustav kapitali oshirildi (Taqsimlanmagan foyda hisobidan) (20,000,000 so'm)", dt: "8710", kt: "8330", sum: 20000000 },
            { q: "Ta'sischi korxonadan chiqib ketdi va ulushi qaytarib berildi (Pulda) (10,000,000 so'm)", dt: "4610", kt: "5110", sum: 10000000 },
            { q: "Avval shakllangan ustav kapitali kamaytirildi (Qarzdorlik bekor qilindi) (5,000,000 so'm)", dt: "8330", kt: "4610", sum: 5000000 }
        ];

        let currentQIndex = 0;

        function openQuiz() {
            currentQIndex = 0;
            document.getElementById('quiz-modal').style.display = 'flex';
            loadQuestion();
        }

        function closeQuiz() {
            document.getElementById('quiz-modal').style.display = 'none';
        }

        function loadQuestion() {
            if (currentQIndex >= quizQuestions.length) {
                document.getElementById('quiz-content').innerHTML = `
                    <div style="text-align:center; padding:20px;">
                        <h2 style="color:#1e40af;">üéâ Tabriklaymiz!</h2>
                        <p>Siz barcha savollarni muvaffaqiyatli yakunladingiz.</p>
                        <button onclick="closeQuiz()" class="btn btn-primary" style="width:100%; justify-content:center;">Yopish</button>
                        <button onclick="openQuiz()" class="btn btn-print" style="width:100%; margin-top:10px; justify-content:center;">Qayta ishlash</button>
                    </div>
                `;
                return;
            }

            const q = quizQuestions[currentQIndex];
            // Reset content if it was overwritten
            if (!document.getElementById('q-text')) {
                document.getElementById('quiz-content').innerHTML = `
                    <div style="background:#eff6ff; padding:15px; border-radius:8px; margin-bottom:20px; font-weight:bold; color:#1e40af;" id="q-text"></div>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-bottom:10px;">
                        <div>
                            <label style="font-size:0.8rem; font-weight:bold; display:block; margin-bottom:5px;">Debet (Schyot)</label>
                            <input type="text" id="q-dt" placeholder="Mas: 4610" style="width:100%; border:1px solid #bfdbfe;">
                        </div>
                        <div>
                            <label style="font-size:0.8rem; font-weight:bold; display:block; margin-bottom:5px;">Kredit (Schyot)</label>
                            <input type="text" id="q-kt" placeholder="Mas: 8330" style="width:100%; border:1px solid #bfdbfe;">
                        </div>
                    </div>
                    <div style="margin-bottom:20px;">
                        <label style="font-size:0.8rem; font-weight:bold; display:block; margin-bottom:5px;">Summa</label>
                        <input type="number" id="q-sum" placeholder="So'mda kiriting" style="width:100%; border:1px solid #bfdbfe;">
                    </div>
                    <div id="q-feedback" style="margin-bottom:15px; padding:10px; background:#fff; border:1px solid #ccc; border-radius:6px; display:none;"></div>
                    <button onclick="checkAnswer()" class="btn btn-primary" style="width:100%; justify-content:center;">Tekshirish</button>
                 `;
            }

            document.getElementById('q-text').innerText = `${currentQIndex + 1}-Savol: ${q.q}`;
            document.getElementById('q-dt').value = '';
            document.getElementById('q-kt').value = '';
            document.getElementById('q-sum').value = '';
            document.getElementById('q-feedback').innerText = '';
            document.getElementById('q-feedback').style.display = 'none';
        }

        function checkAnswer() {
            const dt = document.getElementById('q-dt').value.trim();
            const kt = document.getElementById('q-kt').value.trim();
            const sum = parseFloat(document.getElementById('q-sum').value) || 0;

            const target = quizQuestions[currentQIndex];
            const feedback = document.getElementById('q-feedback');

            if (dt === target.dt && kt === target.kt && sum === target.sum) {
                feedback.innerHTML = '<span style="color:var(--primary); font-weight:bold;">‚úÖ Javob to\'g\'ri!</span>';
                feedback.style.display = 'block';
                setTimeout(() => {
                    currentQIndex++;
                    loadQuestion();
                }, 1000);
            } else {
                feedback.innerHTML = `<span style="color:#ef4444; font-weight:bold;">‚ùå Xato!</span><br>To'g'ri javob: Dt ${target.dt}, Kt ${target.kt}, Summa: ${target.sum.toLocaleString()}`;
                feedback.style.display = 'block';
            }
        }
    </script>

    <!-- QUIZ MODAL -->
    <div class="modal-overlay" id="quiz-modal"
        style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:9999; justify-content:center; align-items:center;">
        <div
            style="background:white; padding:0; border-radius:16px; width:90%; max-width:500px; text-align:left; overflow:hidden;">
            <div
                style="background:var(--primary); padding:1rem; display:flex; justify-content:space-between; align-items:center; color:white;">
                <h3 style="margin:0;">üß† Bilimni Sinash</h3>
                <button onclick="closeQuiz()"
                    style="background:none; border:none; color:white; font-size:1.5rem; cursor:pointer;">&times;</button>
            </div>
            <div style="padding:1.5rem;" id="quiz-content">
                <!-- Content injected by JS -->
            </div>
        </div>
    </div>

    <!-- LOGIN MODAL -->
    <div class="modal-overlay" id="login-modal" style="display:none;">
        <div class="modal">
            <h2>üîê Korxona Profiliga Kirish</h2>
            <p style="margin-bottom: 1rem; color: #6b7280;">Talaba F.I.Sh va Guruhingizni kiriting:</p>
            <input type="text" id="login_student_name" placeholder="F.I.Sh (Masalan: Aliyev Vali)">
            <input type="text" id="login_student_group" placeholder="Guruh (Masalan: 304-guruh)">
            <button onclick="loginUser()">Boshlash</button>
        </div>
    </div>

    <script>
        // --- LOGIN LOGIC ---
        function checkLogin() {
            const user = sessionStorage.getItem('cp_calaba_name');
            const group = sessionStorage.getItem('cp_calaba_group');
            if (user && group) {
                showStudentInfo(user, group);
            } else {
                document.getElementById('login-modal').style.display = 'flex';
            }
        }

        function loginUser() {
            const name = document.getElementById('login_student_name').value.trim();
            const group = document.getElementById('login_student_group').value.trim();

            if (name && group) {
                sessionStorage.setItem('cp_calaba_name', name);
                sessionStorage.setItem('cp_calaba_group', group);
                document.getElementById('login-modal').style.display = 'none';
                showStudentInfo(name, group);
                loadData(); // Reload data to potentially match user (future proofing)
            } else {
                alert("Iltimos, barcha ma'lumotlarni kiriting!");
            }
        }

        function showStudentInfo(name, group) {
            const display = document.getElementById('header-student-info');
            display.style.display = 'inline-block';
            display.innerHTML = `üë§ Talaba: <span id="disp_name">${name}</span> | Guruh: <span id="disp_group">${group}</span> <span style="cursor:pointer; margin-left:10px;" onclick="logout()" title="Chiqish">‚ùå</span>`;
        }

        function logout() {
            if (confirm("Tizimdan chiqmoqchimisiz?")) {
                sessionStorage.removeItem('cp_calaba_name');
                sessionStorage.removeItem('cp_calaba_group');
                location.reload();
            }
        }

        // Initialize Login Check
        window.addEventListener('load', checkLogin);
    </script>
</body>

</html>